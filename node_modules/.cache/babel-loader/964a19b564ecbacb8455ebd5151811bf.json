{"ast":null,"code":"import _toConsumableArray from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/galshalom/Desktop/Social-Trip/src/Admin/Components/GalleryTable.js\";\n\nimport React from \"react\";\nimport { MDBDataTable, MDBContainer, MDBBtn, MDBModalFooter, MDBModalHeader, MDBModal, MDBRow } from \"mdbreact\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { storage } from \"../../index\";\nimport UploadPicture from \"../UploadPicture.js\";\nimport ModalLoader from \"./LoaderModal\";\nimport Resizer from \"react-image-file-resizer\";\n\nvar GalleryTable = function GalleryTable() {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setopen = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isReady = _useState4[0],\n      setisReady = _useState4[1];\n\n  var pictureNameRef = useRef(null);\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      pictures = _useState6[0],\n      setPictures = _useState6[1];\n\n  var _useState7 = useState({\n    index: 1\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modalIsOpen = _useState8[0],\n      setmodalIsOpen = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      disabledContainer = _useState10[0],\n      setDisabled = _useState10[1];\n\n  var data = {\n    columns: [{\n      label: \"שם\",\n      field: \"name\",\n      sort: \"asc\",\n      width: 150\n    }, {\n      label: \"תמונה\",\n      field: \"picture\",\n      sort: \"asc\",\n      width: 270\n    }, {\n      label: \"מחק תמונה\",\n      field: \"delete\",\n      sort: \"asc\",\n      width: 100\n    }],\n    rows: pictures\n  };\n\n  var areYouSure = function areYouSure(picture) {\n    pictureNameRef.current = picture.target.id;\n    setopen(true);\n  };\n\n  var deleteHandler = function deleteHandler() {\n    setisReady(true);\n    setDisabled(true);\n  };\n\n  var resizer = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item, thumbnailsRef) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              Resizer.imageFileResizer(item, 200, 100, \"PNG\", 100, 0, /*#__PURE__*/function () {\n                var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(uri) {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return thumbnailsRef.put(uri).then(function (snapshot) {});\n\n                        case 2:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                return function (_x3) {\n                  return _ref2.apply(this, arguments);\n                };\n              }(), \"blob\");\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function resizer(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var addPictureHandle = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(pictureFiles) {\n      var storageRef;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              setisReady(true);\n              setDisabled(true);\n              storageRef = storage.ref();\n              _context5.next = 5;\n              return Promise.all(pictureFiles.map( /*#__PURE__*/function () {\n                var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(item) {\n                  var imagesRef, thumbnailsRef;\n                  return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                    while (1) {\n                      switch (_context4.prev = _context4.next) {\n                        case 0:\n                          if (!item) {\n                            _context4.next = 5;\n                            break;\n                          }\n\n                          imagesRef = storageRef.child(\"CaruselPhotos/\".concat(item.name));\n                          thumbnailsRef = storageRef.child(\"CaruselPhotos/thumbnails/\".concat(item.name));\n                          _context4.next = 5;\n                          return imagesRef.put(item).then( /*#__PURE__*/function () {\n                            var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(snapshot) {\n                              return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                                while (1) {\n                                  switch (_context3.prev = _context3.next) {\n                                    case 0:\n                                      _context3.next = 2;\n                                      return resizer(item, thumbnailsRef);\n\n                                    case 2:\n                                    case \"end\":\n                                      return _context3.stop();\n                                  }\n                                }\n                              }, _callee3);\n                            }));\n\n                            return function (_x6) {\n                              return _ref5.apply(this, arguments);\n                            };\n                          }());\n\n                        case 5:\n                        case \"end\":\n                          return _context4.stop();\n                      }\n                    }\n                  }, _callee4);\n                }));\n\n                return function (_x5) {\n                  return _ref4.apply(this, arguments);\n                };\n              }()));\n\n            case 5:\n              setisReady(false);\n              setDisabled(false);\n\n            case 7:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function addPictureHandle(_x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (!isReady) {\n      setPictures(function (state) {\n        return [state.pictures];\n      });\n      var storageRef = storage.ref();\n      var imagesRef = storageRef.child(\"CaruselPhotos\");\n      imagesRef.listAll().then(function (res) {\n        res.items.forEach( /*#__PURE__*/function () {\n          var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(element) {\n            return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n              while (1) {\n                switch (_context6.prev = _context6.next) {\n                  case 0:\n                    _context6.next = 2;\n                    return element.getDownloadURL().then(function (url) {\n                      setPictures(function (oldArray) {\n                        return [].concat(_toConsumableArray(oldArray), [{\n                          name: element.name,\n                          picture: /*#__PURE__*/React.createElement(\"img\", {\n                            src: url,\n                            width: \"150\",\n                            height: \"100\",\n                            __self: _this,\n                            __source: {\n                              fileName: _jsxFileName,\n                              lineNumber: 104,\n                              columnNumber: 26\n                            }\n                          }),\n                          delete: /*#__PURE__*/React.createElement(MDBBtn, {\n                            size: \"sm\",\n                            outline: true,\n                            color: \"danger\",\n                            id: \"\".concat(element.name),\n                            onClick: areYouSure,\n                            __self: _this,\n                            __source: {\n                              fileName: _jsxFileName,\n                              lineNumber: 106,\n                              columnNumber: 19\n                            }\n                          }, \"\\u05DE\\u05D7\\u05E7\")\n                        }]);\n                      });\n                    });\n\n                  case 2:\n                  case \"end\":\n                    return _context6.stop();\n                }\n              }\n            }, _callee6);\n          }));\n\n          return function (_x7) {\n            return _ref6.apply(this, arguments);\n          };\n        }());\n        setisReady(false);\n        setDisabled(false);\n      }).catch(function (error) {\n        console.error(\"unable to fetch data : \", error);\n      });\n    } else if (pictureNameRef.current) {\n      setopen(false);\n\n      var _storageRef = storage.ref();\n\n      var imageRef = _storageRef.child(\"CaruselPhotos/\".concat(pictureNameRef.current));\n\n      var thumbnailsRef = _storageRef.child(\"CaruselPhotos/thumbnails/\".concat(pictureNameRef.current));\n\n      imageRef.delete().then(function () {\n        thumbnailsRef.delete().then(function () {\n          setisReady(false);\n          setDisabled(false);\n          pictureNameRef.current = null;\n        }).catch(function (error) {\n          console.error(\"Error removing document: \", error);\n        });\n      }).catch(function (error) {\n        console.error(\"Error removing document: \", error);\n      });\n    }\n  }, [isReady]);\n  return /*#__PURE__*/React.createElement(MDBContainer, {\n    style: {\n      backgroundColor: \"white\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(MDBDataTable, {\n    style: disabledContainer ? {\n      pointerEvents: \"none\",\n      opacity: \"0.4\"\n    } : {},\n    entriesLabel: \"\\u05DE\\u05E1\\u05E4\\u05E8 \\u05D4\\u05E2\\u05E8\\u05DB\\u05D9\\u05DD \\u05D1\\u05D8\\u05D1\\u05DC\\u05D4\",\n    paginationLabel: [\"הקודם\", \"הבא\"],\n    infoLabel: [\"מראה\", \"עד\", \"מתוך\", \"ערכים\"],\n    className: \"text-right justify-content-center\",\n    searchLabel: \"\\u05D7\\u05D9\\u05E4\\u05D5\\u05E9\",\n    btn: true,\n    scrollY: true,\n    maxHeight: \"65vh\",\n    striped: true,\n    bordered: true,\n    small: true,\n    data: data,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }), isReady ? /*#__PURE__*/React.createElement(ModalLoader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 18\n    }\n  }) : null, /*#__PURE__*/React.createElement(MDBModal, {\n    isOpen: open,\n    toggle: function toggle() {\n      return setopen(false);\n    },\n    backdrop: true,\n    size: \"sm\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(MDBModalHeader, {\n    style: {\n      backgroundColor: \"#ff4444\"\n    },\n    className: \"text-white justify-content-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  }, \"\\u05D4\\u05D0\\u05DD \\u05DC\\u05DE\\u05D7\\u05D5\\u05E7 \\u05D0\\u05EA \\u05D4\\u05EA\\u05DE\\u05D5\\u05E0\\u05D4?\"), /*#__PURE__*/React.createElement(MDBModalFooter, {\n    className: \"justify-content-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(MDBBtn, {\n    color: \"danger\",\n    onClick: function onClick() {\n      return setopen(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }, \"\\u05D1\\u05D9\\u05D8\\u05D5\\u05DC\"), /*#__PURE__*/React.createElement(MDBBtn, {\n    outline: true,\n    color: \"danger\",\n    onClick: deleteHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }\n  }, \"\\u05DE\\u05D7\\u05E7\"))), /*#__PURE__*/React.createElement(MDBRow, {\n    className: \"text-center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(UploadPicture, {\n    disabled: disabledContainer,\n    addPictureHandle: addPictureHandle,\n    value: function value(i) {\n      return setmodalIsOpen({\n        index: i\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default GalleryTable;","map":{"version":3,"sources":["/Users/galshalom/Desktop/Social-Trip/src/Admin/Components/GalleryTable.js"],"names":["React","MDBDataTable","MDBContainer","MDBBtn","MDBModalFooter","MDBModalHeader","MDBModal","MDBRow","useEffect","useState","useRef","storage","UploadPicture","ModalLoader","Resizer","GalleryTable","open","setopen","isReady","setisReady","pictureNameRef","pictures","setPictures","index","modalIsOpen","setmodalIsOpen","disabledContainer","setDisabled","data","columns","label","field","sort","width","rows","areYouSure","picture","current","target","id","deleteHandler","resizer","item","thumbnailsRef","imageFileResizer","uri","put","then","snapshot","addPictureHandle","pictureFiles","storageRef","ref","Promise","all","map","imagesRef","child","name","state","listAll","res","items","forEach","element","getDownloadURL","url","oldArray","delete","catch","error","console","imageRef","backgroundColor","pointerEvents","opacity","i"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  MDBDataTable,\n  MDBContainer,\n  MDBBtn,\n  MDBModalFooter,\n  MDBModalHeader,\n  MDBModal,\n  MDBRow,\n} from \"mdbreact\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { storage } from \"../../index\";\nimport UploadPicture from \"../UploadPicture.js\";\nimport ModalLoader from \"./LoaderModal\";\nimport Resizer from \"react-image-file-resizer\";\n\nconst GalleryTable = () => {\n  const [open, setopen] = useState(false);\n  const [isReady, setisReady] = useState(false);\n  const pictureNameRef = useRef(null);\n  const [pictures, setPictures] = useState([]);\n  const [modalIsOpen, setmodalIsOpen] = useState({ index: 1 });\n  const [disabledContainer, setDisabled] = useState(false);\n  const data = {\n    columns: [\n      {\n        label: \"שם\",\n        field: \"name\",\n        sort: \"asc\",\n        width: 150,\n      },\n      {\n        label: \"תמונה\",\n        field: \"picture\",\n        sort: \"asc\",\n        width: 270,\n      },\n      {\n        label: \"מחק תמונה\",\n        field: \"delete\",\n        sort: \"asc\",\n        width: 100,\n      },\n    ],\n    rows: pictures,\n  };\n\n  const areYouSure = (picture) => {\n    pictureNameRef.current = picture.target.id;\n    setopen(true);\n  };\n\n  const deleteHandler = () => {\n    setisReady(true);\n    setDisabled(true);\n  };\n  const resizer = async (item, thumbnailsRef) => {\n    Resizer.imageFileResizer(\n      item,\n      200,\n      100,\n      \"PNG\",\n      100,\n      0,\n      async (uri) => {\n        await thumbnailsRef.put(uri).then((snapshot) => {});\n      },\n      \"blob\"\n    );\n  };\n  const addPictureHandle = async (pictureFiles) => {\n    setisReady(true);\n    setDisabled(true);\n    const storageRef = storage.ref();\n    await Promise.all(\n      pictureFiles.map(async (item) => {\n        if (item) {\n          var imagesRef = storageRef.child(`CaruselPhotos/${item.name}`);\n          var thumbnailsRef = storageRef.child(\n            `CaruselPhotos/thumbnails/${item.name}`\n          );\n          await imagesRef.put(item).then(async (snapshot) => {\n            await resizer(item, thumbnailsRef);\n          });\n        }\n      })\n    );\n    setisReady(false);\n    setDisabled(false);\n  };\n\n  useEffect(() => {\n    if (!isReady) {\n      setPictures((state) => [state.pictures]);\n      const storageRef = storage.ref();\n      const imagesRef = storageRef.child(\"CaruselPhotos\");\n      imagesRef.listAll().then((res) => {\n        res.items.forEach(async (element) => {\n          await element.getDownloadURL().then((url) => {\n            setPictures((oldArray) => [\n              ...oldArray,\n              {\n                name: element.name,\n                picture: <img src={url} width=\"150\" height=\"100\" />,\n                delete: (\n                  <MDBBtn\n                    size=\"sm\"\n                    outline\n                    color=\"danger\"\n                    id={`${element.name}`}\n                    onClick={areYouSure}\n                  >\n                    מחק\n                  </MDBBtn>\n                ),\n              },\n            ]);\n          });\n        });\n        setisReady(false);\n        setDisabled(false);\n      }).catch( (error) => {\n        console.error(\"unable to fetch data : \", error);\n      });\n    } else if (pictureNameRef.current) {\n      setopen(false);\n      const storageRef = storage.ref();\n      const imageRef = storageRef.child(\n        `CaruselPhotos/${pictureNameRef.current}`\n      );\n      const thumbnailsRef = storageRef.child(\n        `CaruselPhotos/thumbnails/${pictureNameRef.current}`\n      );\n      imageRef\n        .delete()\n        .then(() => {\n          thumbnailsRef\n            .delete()\n            .then(() => {\n              setisReady(false);\n              setDisabled(false);\n              pictureNameRef.current = null;\n            })\n            .catch(function (error) {\n              console.error(\"Error removing document: \", error);\n            });\n        })\n        .catch(function (error) {\n          console.error(\"Error removing document: \", error);\n        });\n    }\n  }, [isReady]);\n\n  return (\n    <MDBContainer style={{ backgroundColor: \"white\" }}>\n      <MDBDataTable\n        style={\n          disabledContainer ? { pointerEvents: \"none\", opacity: \"0.4\" } : {}\n        }\n        entriesLabel=\"מספר הערכים בטבלה\"\n        paginationLabel={[\"הקודם\", \"הבא\"]}\n        infoLabel={[\"מראה\", \"עד\", \"מתוך\", \"ערכים\"]}\n        className=\"text-right justify-content-center\"\n        searchLabel=\"חיפוש\"\n        btn\n        scrollY\n        maxHeight=\"65vh\"\n        striped\n        bordered\n        small\n        data={data}\n      />\n      {isReady ? <ModalLoader /> : null}\n      <MDBModal\n        isOpen={open}\n        toggle={() => setopen(false)}\n        backdrop={true}\n        size=\"sm\"\n      >\n        <MDBModalHeader\n          style={{ backgroundColor: \"#ff4444\" }}\n          className=\"text-white justify-content-center\"\n        >\n          האם למחוק את התמונה?\n        </MDBModalHeader>\n        <MDBModalFooter className=\"justify-content-center\">\n          <MDBBtn color=\"danger\" onClick={() => setopen(false)}>\n            ביטול\n          </MDBBtn>\n          <MDBBtn outline color=\"danger\" onClick={deleteHandler}>\n            מחק\n          </MDBBtn>\n        </MDBModalFooter>\n      </MDBModal>\n      <MDBRow className=\"text-center\">\n        <UploadPicture\n          disabled={disabledContainer}\n          addPictureHandle={addPictureHandle}\n          value={(i) => setmodalIsOpen({ index: i })}\n        />\n      </MDBRow>\n    </MDBContainer>\n  );\n};\n\nexport default GalleryTable;\n"]},"metadata":{},"sourceType":"module"}