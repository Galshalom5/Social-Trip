{"ast":null,"code":"import _toConsumableArray from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/galshalom/Desktop/Social-Trip/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/galshalom/Desktop/Social-Trip/src/Admin/GalleryMangment.js\";\nimport React, { Component } from \"react\";\nimport { db } from \"../index\";\nimport $ from \"jquery\";\nimport Resizer from \"react-image-file-resizer\";\nimport { MDBContainer, MDBModal, MDBModalBody, MDBModalHeader, MDBModalFooter, MDBInput, MDBBtn } from \"mdbreact\";\nimport GalleryTable from \"./Components/GalleryTable.js\";\nimport \"../css/Admin.css\";\nimport { storage } from \"../index\";\nimport SpinnerPage from \"./Components/SpinnerPage\";\n\nvar GalleryMangment = /*#__PURE__*/function (_Component) {\n  _inherits(GalleryMangment, _Component);\n\n  var _super = _createSuper(GalleryMangment);\n\n  function GalleryMangment() {\n    var _this;\n\n    _classCallCheck(this, GalleryMangment);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      modal17: false,\n      filePath: \"\",\n      fileName: \"\",\n      loading: false,\n      Pictures: []\n    };\n\n    _this.deletePicture = function (name) {\n      var storageRef = storage.ref();\n      var imageRef = storageRef.child(\"CaruselPhotos/\".concat(name));\n      var thumbnailsRef = storageRef.child(\"CaruselPhotos/thumbnails/\".concat(name));\n      imageRef.delete().then(function () {\n        thumbnailsRef.delete().then(function () {\n          _this.setState({\n            Pictures: _this.state.Pictures.filter(function (item, index) {\n              if (name != item.imageName) {\n                return item;\n              }\n            })\n          });\n        }).catch(function (error) {\n          console.error(\"Error removing document: \", error);\n        });\n      }).catch(function (error) {\n        console.error(\"Error removing document: \", error);\n      });\n    };\n\n    _this.addPicture = function (picture) {\n      var storageRef = storage.ref();\n      var imagesRef = storageRef.child(\"CaruselPhotos/\".concat(picture.name));\n      var thumbnailsRef = storageRef.child(\"CaruselPhotos/thumbnails/\".concat(picture.name));\n      $(\".GalleryForm\")[0].classList.remove(\"was-validated\");\n      imagesRef.put(picture).then(function (snapshot) {\n        imagesRef.getDownloadURL().then(function (url) {\n          _this.setState({\n            Pictures: [].concat(_toConsumableArray(_this.state.Pictures), [{\n              imageUrl: url,\n              imageName: picture.name\n            }])\n          });\n\n          console.log(\"Uploaded file to CaruselPhotos\");\n          Resizer.imageFileResizer(picture, 350, 250, \"JPEG\", 55, 0, function (uri) {\n            thumbnailsRef.put(uri).then(function (snapshot) {\n              console.log(\"Uploaded file to thumbnails\");\n\n              _this.setState({\n                [\"modal17\"]: !_this.state[\"modal17\"],\n                loading: false\n              });\n            });\n          }, \"blob\");\n        });\n      });\n    };\n\n    _this.toggle = function (nr) {\n      return function () {\n        var modalNumber = \"modal\" + nr;\n\n        _this.setState({\n          [modalNumber]: !_this.state[modalNumber]\n        });\n      };\n    };\n\n    _this.fetchData = function () {\n      var storageRef = storage.ref();\n      var imagesRef = storageRef.child(\"CaruselPhotos\");\n      imagesRef.listAll().then(function (res) {\n        res.items.forEach(function (element) {\n          element.getDownloadURL().then(function (url) {\n            console.log(\"set new state\");\n\n            _this.setState({\n              Pictures: [].concat(_toConsumableArray(_this.state.Pictures), [{\n                imageUrl: url,\n                imageName: element.name\n              }])\n            });\n          });\n        });\n      });\n    };\n\n    _this.submitHandler = function (file) {\n      if ($(\".GalleryForm\")[0].checkValidity()) {\n        _this.setState({\n          loading: true\n        });\n\n        _this.addPicture(file);\n      }\n\n      $(\".GalleryForm\")[0].classList.add(\"was-validated\");\n    };\n\n    return _this;\n  }\n\n  _createClass(GalleryMangment, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchData();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var fileName = this.state.fileName;\n      var file = null;\n      file = fileName ? /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 23\n        }\n      }, fileName) : /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 49\n        }\n      }, \"\\u05D0\\u05E0\\u05D0 \\u05D1\\u05D7\\u05E8 \\u05EA\\u05DE\\u05D5\\u05E0\\u05D4\");\n      return /*#__PURE__*/React.createElement(MDBContainer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(GalleryTable, {\n        deletePicture: this.deletePicture,\n        toggle: this.toggle,\n        Pictures: this.state.Pictures,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(MDBModal, {\n        position: \"left-top\",\n        isOpen: this.state.modal17,\n        toggle: this.toggle(17),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 9\n        }\n      }, this.state.loading ? /*#__PURE__*/React.createElement(SpinnerPage, {\n        className: \"spinner\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 33\n        }\n      }) : /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 70\n        }\n      }, \"   \", /*#__PURE__*/React.createElement(MDBModalHeader, {\n        dir: \"rtl\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 78\n        }\n      }, \"\\u05D4\\u05D5\\u05E1\\u05E3 \\u05EA\\u05DE\\u05D5\\u05E0\\u05D4\"), /*#__PURE__*/React.createElement(MDBModalBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"form\", {\n        noValidate: true,\n        className: \"needs-validation GalleryForm\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input-group-prepend\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"custom-file\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        required: true,\n        className: \"custom-file-input\",\n        id: \"inputGroupFile01\",\n        \"aria-describedby\": \"inputGroupFileAddon01\",\n        onChange: function onChange(event) {\n          return _this2.setState({\n            filePath: event.target.files[0],\n            fileName: event.target.files[0].name\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"invalid-tooltip\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 19\n        }\n      }, \"\\u05E0\\u05D0 \\u05D4\\u05E2\\u05DC\\u05D4 \\u05E7\\u05D5\\u05D1\\u05E5\"), /*#__PURE__*/React.createElement(\"label\", {\n        className: \"custom-file-label\",\n        htmlFor: \"inputGroupFile01\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 19\n        }\n      }, file))))), /*#__PURE__*/React.createElement(MDBModalFooter, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(MDBBtn, {\n        color: \"danger\",\n        onClick: this.toggle(17),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 13\n        }\n      }, \"\\u05E1\\u05D2\\u05D5\\u05E8\"), /*#__PURE__*/React.createElement(MDBBtn, {\n        onClick: function onClick() {\n          _this2.submitHandler(_this2.state.filePath);\n        },\n        color: \"warning\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }\n      }, \"\\u05D4\\u05E2\\u05DC\\u05D4 \\u05EA\\u05DE\\u05D5\\u05E0\\u05D4\")))));\n    }\n  }]);\n\n  return GalleryMangment;\n}(Component);\n\nexport default GalleryMangment;","map":{"version":3,"sources":["/Users/galshalom/Desktop/Social-Trip/src/Admin/GalleryMangment.js"],"names":["React","Component","db","$","Resizer","MDBContainer","MDBModal","MDBModalBody","MDBModalHeader","MDBModalFooter","MDBInput","MDBBtn","GalleryTable","storage","SpinnerPage","GalleryMangment","state","modal17","filePath","fileName","loading","Pictures","deletePicture","name","storageRef","ref","imageRef","child","thumbnailsRef","delete","then","setState","filter","item","index","imageName","catch","error","console","addPicture","picture","imagesRef","classList","remove","put","snapshot","getDownloadURL","url","imageUrl","log","imageFileResizer","uri","toggle","nr","modalNumber","fetchData","listAll","res","items","forEach","element","submitHandler","file","checkValidity","add","event","target","files"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { db } from \"../index\";\nimport $ from \"jquery\";\nimport Resizer from \"react-image-file-resizer\";\nimport {\n  MDBContainer,\n  MDBModal,\n  MDBModalBody,\n  MDBModalHeader,\n  MDBModalFooter,\n  MDBInput,\n  MDBBtn,\n} from \"mdbreact\";\nimport GalleryTable from \"./Components/GalleryTable.js\";\nimport \"../css/Admin.css\";\nimport { storage } from \"../index\";\nimport SpinnerPage from \"./Components/SpinnerPage\";\n\nclass GalleryMangment extends Component {\n  state = {\n    modal17: false,\n    filePath: \"\",\n    fileName: \"\",\n    loading: false,\n    Pictures: [],\n  };\n\n  deletePicture = (name) => {\n    const storageRef = storage.ref();\n    const imageRef = storageRef.child(`CaruselPhotos/${name}`);\n    const thumbnailsRef = storageRef.child(`CaruselPhotos/thumbnails/${name}`);\n    imageRef\n      .delete()\n      .then(() => {\n        thumbnailsRef\n          .delete()\n          .then(() => {\n            this.setState({\n              Pictures: this.state.Pictures.filter((item, index) => {\n                if (name != item.imageName) {\n                  return item;\n                }\n              }),\n            });\n          })\n          .catch(function (error) {\n            console.error(\"Error removing document: \", error);\n          });\n      })\n      .catch(function (error) {\n        console.error(\"Error removing document: \", error);\n      });\n  };\n  addPicture = (picture) => {\n    const storageRef = storage.ref();\n    const imagesRef = storageRef.child(`CaruselPhotos/${picture.name}`);\n    const thumbnailsRef = storageRef.child(\n      `CaruselPhotos/thumbnails/${picture.name}`\n    );\n    $(\".GalleryForm\")[0].classList.remove(\"was-validated\");\n    imagesRef.put(picture).then((snapshot) => {\n      imagesRef.getDownloadURL().then((url) => {\n        this.setState({\n          Pictures: [\n            ...this.state.Pictures,\n            { imageUrl: url, imageName: picture.name },\n          ],\n        });\n        console.log(\"Uploaded file to CaruselPhotos\");\n        Resizer.imageFileResizer(\n          picture,\n          350,\n          250,\n          \"JPEG\",\n          55,\n          0,\n          (uri) => {\n            thumbnailsRef.put(uri).then((snapshot) => {\n              console.log(\"Uploaded file to thumbnails\");\n              this.setState({\n                [\"modal17\"]: !this.state[\"modal17\"],\n                loading: false,\n              });\n\n            });\n          },\n          \"blob\"\n        );\n      });\n    });\n  };\n\n  toggle = (nr) => () => {\n    let modalNumber = \"modal\" + nr;\n    this.setState({\n      [modalNumber]: !this.state[modalNumber],\n    });\n  };\n\n  fetchData = () => {\n    const storageRef = storage.ref();\n    const imagesRef = storageRef.child(\"CaruselPhotos\");\n    imagesRef.listAll().then((res) => {\n      res.items.forEach((element) => {\n        element.getDownloadURL().then((url) => {\n          console.log(\"set new state\");\n          this.setState({\n            Pictures: [\n              ...this.state.Pictures,\n              { imageUrl: url, imageName: element.name },\n            ],\n          });\n        });\n      });\n    });\n  };\n  componentDidMount() {\n    this.fetchData();\n  }\n  submitHandler = (file) => {\n    if ($(\".GalleryForm\")[0].checkValidity()) {\n      this.setState({\n        loading: true,\n      });\n      this.addPicture(file);\n    }\n    $(\".GalleryForm\")[0].classList.add(\"was-validated\");\n  };\n\n  render() {\n    const { fileName } = this.state;\n    let file = null;\n\n    file = fileName ? <span>{fileName}</span> : <span>אנא בחר תמונה</span>;\n    return (\n      <MDBContainer>\n        <GalleryTable\n          deletePicture={this.deletePicture}\n          toggle={this.toggle}\n          Pictures={this.state.Pictures}\n        />\n        <MDBModal\n          position=\"left-top\"\n          isOpen={this.state.modal17}\n          toggle={this.toggle(17)}\n        >\n          {this.state.loading ? <SpinnerPage className ='spinner'/> :<div>   <MDBModalHeader dir=\"rtl\">הוסף תמונה</MDBModalHeader>\n          <MDBModalBody>\n            <form noValidate className=\"needs-validation GalleryForm\">\n              <div className=\"input-group\">\n                <div className=\"input-group-prepend\"></div>\n                <div className=\"custom-file\">\n                  <input\n                    type=\"file\"\n                    required\n                    className=\"custom-file-input\"\n                    id=\"inputGroupFile01\"\n                    aria-describedby=\"inputGroupFileAddon01\"\n                    onChange={(event) =>\n                      this.setState({\n                        filePath: event.target.files[0],\n                        fileName: event.target.files[0].name,\n                      })\n                    }\n                  />\n                  <div className=\"invalid-tooltip\">נא העלה קובץ</div>\n\n                  <label\n                    className=\"custom-file-label\"\n                    htmlFor=\"inputGroupFile01\"\n                  >\n                    {file}\n                  </label>\n                </div>\n              </div>\n            </form>\n          </MDBModalBody>\n          <MDBModalFooter>\n            <MDBBtn color=\"danger\" onClick={this.toggle(17)}>\n              סגור\n            </MDBBtn>\n            <MDBBtn\n              onClick={() => {\n                this.submitHandler(this.state.filePath);\n              }}\n              color=\"warning\"\n            >\n              העלה תמונה\n            </MDBBtn>\n          </MDBModalFooter></div> }\n       \n        </MDBModal>\n      </MDBContainer>\n    );\n  }\n}\n\nexport default GalleryMangment;\n"]},"metadata":{},"sourceType":"module"}